{"version":3,"sources":["../../../src/components/AnimationOnScroll.tsx"],"names":["animatedClass","serverSide","window","scrollableParentRefInitialValue","undefined","AnimationOnScroll","offset","duration","styleProps","style","classNameProps","className","initiallyVisible","animateIn","afterAnimatedIn","animateOut","delay","animatePreScroll","afterAnimatedOut","scrollableParentSelector","animateOnce","children","classes","setClasses","animationDuration","opacity","setStyle","node","animating","visibilityRef","onScreen","inViewport","delayedAnimationTORef","callbackTORef","scrollableParentRef","getElementTop","elm","yPos","offsetTop","clientTop","offsetParent","getScrollPos","current","pageYOffset","scrollTop","getScrollableParentHeight","innerHeight","clientHeight","getViewportTop","getViewportBottom","isInViewport","y","isAboveViewport","isBelowViewport","elementTop","elementBottom","isAboveScreen","isBelowScreen","getVisibility","visibilityHasChanged","previousVis","currentVis","animate","animation","callback","setTimeout","animateInTrigger","vis","animateOutTrigger","handleScroll","visibility","clearTimeout","listener","parentSelector","document","querySelector","addEventListener","console","warn","removeEventListener","Object","assign"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  useState,\n  useEffect,\n  useRef,\n} from 'react';\nimport throttle from 'lodash.throttle';\n\nconst animatedClass = 'animate__animated';\nconst serverSide = typeof window === 'undefined';\n\nlet scrollableParentRefInitialValue: any = undefined;\nif (!serverSide) {\n  scrollableParentRefInitialValue = window;\n}\n\ntype Props = {\n  offset?: number;\n  duration?: number;\n  style?: any;\n  className?: string;\n  initiallyVisible?: boolean;\n  animateIn?: string;\n  afterAnimatedIn?: any;\n  animateOut?: string;\n  delay?: number;\n  animatePreScroll?: boolean;\n  afterAnimatedOut?: any;\n  scrollableParentSelector?: string;\n  animateOnce?: boolean;\n  children?: any;\n};\n\ntype styleProp = {\n  animationDuration: string;\n  opacity?: number;\n};\n\nexport const AnimationOnScroll = ({\n  offset = 150,\n  duration = 1,\n  style: styleProps,\n  className: classNameProps,\n  initiallyVisible = false,\n  animateIn,\n  afterAnimatedIn,\n  animateOut,\n  delay = 0,\n  animatePreScroll = true,\n  afterAnimatedOut,\n  scrollableParentSelector,\n  animateOnce = false,\n  children,\n}: Props) => {\n  const [classes, setClasses] = useState(animatedClass);\n  const [style, setStyle] = useState<styleProp>({\n    animationDuration: `${duration}s`,\n    opacity: initiallyVisible ? 1 : 0,\n  });\n\n  const node: { current: any } = useRef(null);\n  const animating: { current: boolean } = useRef(false);\n  const visibilityRef: {\n    current: { onScreen: boolean; inViewport: boolean };\n  } = useRef({ onScreen: false, inViewport: false });\n\n  const delayedAnimationTORef: { current: any } = useRef(undefined);\n  const callbackTORef: { current: any } = useRef(undefined);\n  const scrollableParentRef: { current: any } = useRef(scrollableParentRefInitialValue);\n\n  const getElementTop = useCallback((elm: any) => {\n    let yPos = 0;\n    while (elm && elm.offsetTop !== undefined && elm.clientTop !== undefined) {\n      yPos += elm.offsetTop + elm.clientTop;\n      elm = elm.offsetParent;\n    }\n    return yPos;\n  }, []);\n\n  const getScrollPos = useCallback(() => {\n    if (scrollableParentRef.current.pageYOffset !== undefined) {\n      return scrollableParentRef.current.pageYOffset;\n    }\n    return scrollableParentRef.current.scrollTop;\n  }, [scrollableParentRef]);\n\n  const getScrollableParentHeight = useCallback(() => {\n    if (scrollableParentRef.current.innerHeight !== undefined) {\n      return scrollableParentRef.current.innerHeight;\n    }\n    return scrollableParentRef.current.clientHeight;\n  }, [scrollableParentRef]);\n\n  const getViewportTop = useCallback(() => {\n    return getScrollPos() + offset;\n  }, [offset, getScrollPos]);\n\n  const getViewportBottom = useCallback(() => {\n    return getScrollPos() + getScrollableParentHeight() - offset;\n  }, [offset, getScrollPos, getScrollableParentHeight]);\n\n  const isInViewport = useCallback(\n    (y) => {\n      return y >= getViewportTop() && y <= getViewportBottom();\n    },\n    [getViewportTop, getViewportBottom]\n  );\n\n  const isAboveViewport = useCallback(\n    (y) => {\n      return y < getViewportTop();\n    },\n    [getViewportTop]\n  );\n\n  const isBelowViewport = useCallback(\n    (y) => {\n      return y > getViewportBottom();\n    },\n    [getViewportBottom]\n  );\n\n  const inViewport = useCallback(\n    (elementTop, elementBottom) => {\n      return (\n        isInViewport(elementTop) ||\n        isInViewport(elementBottom) ||\n        (isAboveViewport(elementTop) && isBelowViewport(elementBottom))\n      );\n    },\n    [isInViewport, isAboveViewport, isBelowViewport]\n  );\n\n  const isAboveScreen = useCallback(\n    (y) => {\n      return y < getScrollPos();\n    },\n    [getScrollPos]\n  );\n\n  const isBelowScreen = useCallback(\n    (y) => {\n      return y > getScrollPos() + getScrollableParentHeight();\n    },\n    [getScrollPos, getScrollableParentHeight]\n  );\n\n  const onScreen = useCallback(\n    (elementTop, elementBottom) => {\n      return !isAboveScreen(elementBottom) && !isBelowScreen(elementTop);\n    },\n    [isAboveScreen, isBelowScreen]\n  );\n\n  const getVisibility = useCallback(() => {\n    const elementTop =\n      getElementTop(node.current) - getElementTop(scrollableParentRef.current);\n    const elementBottom = elementTop + node.current.clientHeight;\n\n    return {\n      inViewport: inViewport(elementTop, elementBottom),\n      onScreen: onScreen(elementTop, elementBottom),\n    };\n  }, [getElementTop, node, inViewport, onScreen, scrollableParentRef]);\n\n  const visibilityHasChanged = useCallback((previousVis, currentVis) => {\n    return (\n      previousVis.inViewport !== currentVis.inViewport ||\n      previousVis.onScreen !== currentVis.onScreen\n    );\n  }, []);\n\n  const animate = useCallback(\n    (animation, callback) => {\n      delayedAnimationTORef.current = setTimeout(() => {\n        animating.current = true;\n        setClasses(`${animatedClass} ${animation}`);\n        setStyle({ animationDuration: `${duration}s` });\n        callbackTORef.current = setTimeout(callback, duration * 1000);\n      }, delay);\n    },\n    [animating, delay, duration]\n  );\n\n  const animateInTrigger = useCallback(\n    (callback) => {\n      animate(animateIn, () => {\n        if (!animateOnce) {\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: 1,\n          });\n          animating.current = false;\n        }\n        const vis = getVisibility();\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [animating, animateIn, animateOnce, duration, animate, getVisibility]\n  );\n\n  const animateOutTrigger = useCallback(\n    (callback) => {\n      animate(animateOut, () => {\n        setClasses(animatedClass);\n        setStyle({ animationDuration: `${duration}s`, opacity: 0 });\n        const vis = getVisibility();\n\n        if (vis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else {\n          animating.current = false;\n        }\n\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [\n      animating,\n      animate,\n      animateIn,\n      duration,\n      afterAnimatedIn,\n      animateInTrigger,\n      animateOut,\n      getVisibility,\n    ]\n  );\n\n  const handleScroll = useCallback(() => {\n    if (!animating.current) {\n      const { current: visibility } = visibilityRef;\n      const currentVis = getVisibility();\n      if (visibilityHasChanged(visibility, currentVis)) {\n        clearTimeout(delayedAnimationTORef.current);\n        if (!currentVis.onScreen) {\n          setClasses(animatedClass);\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: initiallyVisible ? 1 : 0,\n          });\n        } else if (currentVis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else if (\n          currentVis.onScreen &&\n          visibility.inViewport &&\n          animateOut &&\n          node.current.style.opacity === '1'\n        ) {\n          animateOutTrigger(afterAnimatedOut);\n        }\n        visibilityRef.current = currentVis;\n      }\n    }\n  }, [\n    afterAnimatedIn,\n    afterAnimatedOut,\n    animateIn,\n    animateInTrigger,\n    animateOut,\n    duration,\n    initiallyVisible,\n    visibilityHasChanged,\n    animateOutTrigger,\n    getVisibility,\n  ]);\n\n  const listener = useMemo(\n    () =>\n      throttle(() => {\n        handleScroll();\n      }, 50),\n    [handleScroll]\n  );\n\n  useEffect(() => {\n    if (!serverSide) {\n      const parentSelector = scrollableParentSelector;\n      scrollableParentRef.current = parentSelector\n        ? document.querySelector(parentSelector)\n        : window;\n      if (\n        scrollableParentRef.current &&\n        scrollableParentRef.current.addEventListener\n      ) {\n        scrollableParentRef.current.addEventListener('scroll', listener);\n      } else {\n        console.warn(\n          `Cannot find element by locator: ${scrollableParentSelector}`\n        );\n      }\n      if (animatePreScroll) {\n        handleScroll();\n      }\n\n      return () => {\n        clearTimeout(delayedAnimationTORef.current);\n        clearTimeout(callbackTORef.current);\n        if (window && window.removeEventListener) {\n          window.removeEventListener('scroll', listener);\n        }\n      };\n    }\n  }, [\n    handleScroll,\n    scrollableParentSelector,\n    scrollableParentRef,\n    listener,\n    animatePreScroll,\n  ]);\n\n  return (\n    <div\n      ref={node}\n      className={classNameProps ? `${classNameProps} ${classes}` : classes}\n      style={Object.assign({}, style, styleProps)}\n    >\n      {children}\n    </div>\n  );\n};\n"],"file":"AnimationOnScroll.js"}