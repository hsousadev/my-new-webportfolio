{"version":3,"file":"AnimationOnScroll.js","mappings":"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","names":["animatedClass","serverSide","window","scrollableParentRefInitialValue","undefined","AnimationOnScroll","offset","duration","style","styleProps","className","classNameProps","initiallyVisible","animateIn","afterAnimatedIn","animateOut","delay","animatePreScroll","afterAnimatedOut","scrollableParentSelector","animateOnce","children","classes","setClasses","useState","setStyle","animationDuration","opacity","node","useRef","animating","visibilityRef","onScreen","inViewport","delayedAnimationTORef","callbackTORef","scrollableParentRef","getElementTop","useCallback","elm","yPos","offsetTop","clientTop","offsetParent","getScrollPos","current","pageYOffset","scrollTop","getScrollableParentHeight","innerHeight","clientHeight","getViewportTop","getViewportBottom","isInViewport","y","isAboveViewport","isBelowViewport","elementTop","elementBottom","isAboveScreen","isBelowScreen","getVisibility","visibilityHasChanged","previousVis","currentVis","animate","animation","callback","setTimeout","animateInTrigger","vis","animateOutTrigger","handleScroll","visibility","clearTimeout","listener","useMemo","throttle","useEffect","parentSelector","document","querySelector","addEventListener","console","warn","removeEventListener","React","ref","Object","assign"],"sources":["../../../src/components/AnimationOnScroll.tsx"],"sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  useState,\n  useEffect,\n  useRef,\n} from 'react';\nimport throttle from 'lodash.throttle';\n\nconst animatedClass = 'animate__animated';\nconst serverSide = typeof window === 'undefined';\n\nlet scrollableParentRefInitialValue: any = undefined;\nif (!serverSide) {\n  scrollableParentRefInitialValue = window;\n}\n\ntype Props = {\n  offset?: number;\n  duration?: number;\n  style?: any;\n  className?: string;\n  initiallyVisible?: boolean;\n  animateIn?: string;\n  afterAnimatedIn?: any;\n  animateOut?: string;\n  delay?: number;\n  animatePreScroll?: boolean;\n  afterAnimatedOut?: any;\n  scrollableParentSelector?: string;\n  animateOnce?: boolean;\n  children?: any;\n};\n\ntype styleProp = {\n  animationDuration: string;\n  opacity?: number;\n};\n\nexport const AnimationOnScroll = ({\n  offset = 150,\n  duration = 1,\n  style: styleProps,\n  className: classNameProps,\n  initiallyVisible = false,\n  animateIn,\n  afterAnimatedIn,\n  animateOut,\n  delay = 0,\n  animatePreScroll = true,\n  afterAnimatedOut,\n  scrollableParentSelector,\n  animateOnce = false,\n  children,\n}: Props) => {\n  const [classes, setClasses] = useState(animatedClass);\n  const [style, setStyle] = useState<styleProp>({\n    animationDuration: `${duration}s`,\n    opacity: initiallyVisible ? 1 : 0,\n  });\n\n  const node: { current: any } = useRef(null);\n  const animating: { current: boolean } = useRef(false);\n  const visibilityRef: {\n    current: { onScreen: boolean; inViewport: boolean };\n  } = useRef({ onScreen: false, inViewport: false });\n\n  const delayedAnimationTORef: { current: any } = useRef(undefined);\n  const callbackTORef: { current: any } = useRef(undefined);\n  const scrollableParentRef: { current: any } = useRef(scrollableParentRefInitialValue);\n\n  const getElementTop = useCallback((elm: any) => {\n    let yPos = 0;\n    while (elm && elm.offsetTop !== undefined && elm.clientTop !== undefined) {\n      yPos += elm.offsetTop + elm.clientTop;\n      elm = elm.offsetParent;\n    }\n    return yPos;\n  }, []);\n\n  const getScrollPos = useCallback(() => {\n    if (scrollableParentRef.current.pageYOffset !== undefined) {\n      return scrollableParentRef.current.pageYOffset;\n    }\n    return scrollableParentRef.current.scrollTop;\n  }, [scrollableParentRef]);\n\n  const getScrollableParentHeight = useCallback(() => {\n    if (scrollableParentRef.current.innerHeight !== undefined) {\n      return scrollableParentRef.current.innerHeight;\n    }\n    return scrollableParentRef.current.clientHeight;\n  }, [scrollableParentRef]);\n\n  const getViewportTop = useCallback(() => {\n    return getScrollPos() + offset;\n  }, [offset, getScrollPos]);\n\n  const getViewportBottom = useCallback(() => {\n    return getScrollPos() + getScrollableParentHeight() - offset;\n  }, [offset, getScrollPos, getScrollableParentHeight]);\n\n  const isInViewport = useCallback(\n    (y) => {\n      return y >= getViewportTop() && y <= getViewportBottom();\n    },\n    [getViewportTop, getViewportBottom]\n  );\n\n  const isAboveViewport = useCallback(\n    (y) => {\n      return y < getViewportTop();\n    },\n    [getViewportTop]\n  );\n\n  const isBelowViewport = useCallback(\n    (y) => {\n      return y > getViewportBottom();\n    },\n    [getViewportBottom]\n  );\n\n  const inViewport = useCallback(\n    (elementTop, elementBottom) => {\n      return (\n        isInViewport(elementTop) ||\n        isInViewport(elementBottom) ||\n        (isAboveViewport(elementTop) && isBelowViewport(elementBottom))\n      );\n    },\n    [isInViewport, isAboveViewport, isBelowViewport]\n  );\n\n  const isAboveScreen = useCallback(\n    (y) => {\n      return y < getScrollPos();\n    },\n    [getScrollPos]\n  );\n\n  const isBelowScreen = useCallback(\n    (y) => {\n      return y > getScrollPos() + getScrollableParentHeight();\n    },\n    [getScrollPos, getScrollableParentHeight]\n  );\n\n  const onScreen = useCallback(\n    (elementTop, elementBottom) => {\n      return !isAboveScreen(elementBottom) && !isBelowScreen(elementTop);\n    },\n    [isAboveScreen, isBelowScreen]\n  );\n\n  const getVisibility = useCallback(() => {\n    const elementTop =\n      getElementTop(node.current) - getElementTop(scrollableParentRef.current);\n    const elementBottom = elementTop + node.current.clientHeight;\n\n    return {\n      inViewport: inViewport(elementTop, elementBottom),\n      onScreen: onScreen(elementTop, elementBottom),\n    };\n  }, [getElementTop, node, inViewport, onScreen, scrollableParentRef]);\n\n  const visibilityHasChanged = useCallback((previousVis, currentVis) => {\n    return (\n      previousVis.inViewport !== currentVis.inViewport ||\n      previousVis.onScreen !== currentVis.onScreen\n    );\n  }, []);\n\n  const animate = useCallback(\n    (animation, callback) => {\n      delayedAnimationTORef.current = setTimeout(() => {\n        animating.current = true;\n        setClasses(`${animatedClass} ${animation}`);\n        setStyle({ animationDuration: `${duration}s` });\n        callbackTORef.current = setTimeout(callback, duration * 1000);\n      }, delay);\n    },\n    [animating, delay, duration]\n  );\n\n  const animateInTrigger = useCallback(\n    (callback) => {\n      animate(animateIn, () => {\n        if (!animateOnce) {\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: 1,\n          });\n          animating.current = false;\n        }\n        const vis = getVisibility();\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [animating, animateIn, animateOnce, duration, animate, getVisibility]\n  );\n\n  const animateOutTrigger = useCallback(\n    (callback) => {\n      animate(animateOut, () => {\n        setClasses(animatedClass);\n        setStyle({ animationDuration: `${duration}s`, opacity: 0 });\n        const vis = getVisibility();\n\n        if (vis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else {\n          animating.current = false;\n        }\n\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [\n      animating,\n      animate,\n      animateIn,\n      duration,\n      afterAnimatedIn,\n      animateInTrigger,\n      animateOut,\n      getVisibility,\n    ]\n  );\n\n  const handleScroll = useCallback(() => {\n    if (!animating.current) {\n      const { current: visibility } = visibilityRef;\n      const currentVis = getVisibility();\n      if (visibilityHasChanged(visibility, currentVis)) {\n        clearTimeout(delayedAnimationTORef.current);\n        if (!currentVis.onScreen) {\n          setClasses(animatedClass);\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: initiallyVisible ? 1 : 0,\n          });\n        } else if (currentVis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else if (\n          currentVis.onScreen &&\n          visibility.inViewport &&\n          animateOut &&\n          node.current.style.opacity === '1'\n        ) {\n          animateOutTrigger(afterAnimatedOut);\n        }\n        visibilityRef.current = currentVis;\n      }\n    }\n  }, [\n    afterAnimatedIn,\n    afterAnimatedOut,\n    animateIn,\n    animateInTrigger,\n    animateOut,\n    duration,\n    initiallyVisible,\n    visibilityHasChanged,\n    animateOutTrigger,\n    getVisibility,\n  ]);\n\n  const listener = useMemo(\n    () =>\n      throttle(() => {\n        handleScroll();\n      }, 50),\n    [handleScroll]\n  );\n\n  useEffect(() => {\n    if (!serverSide) {\n      const parentSelector = scrollableParentSelector;\n      scrollableParentRef.current = parentSelector\n        ? document.querySelector(parentSelector)\n        : window;\n      if (\n        scrollableParentRef.current &&\n        scrollableParentRef.current.addEventListener\n      ) {\n        scrollableParentRef.current.addEventListener('scroll', listener);\n      } else {\n        console.warn(\n          `Cannot find element by locator: ${scrollableParentSelector}`\n        );\n      }\n      if (animatePreScroll) {\n        handleScroll();\n      }\n\n      return () => {\n        clearTimeout(delayedAnimationTORef.current);\n        clearTimeout(callbackTORef.current);\n        if (window && window.removeEventListener) {\n          window.removeEventListener('scroll', listener);\n        }\n      };\n    }\n  }, [\n    handleScroll,\n    scrollableParentSelector,\n    scrollableParentRef,\n    listener,\n    animatePreScroll,\n  ]);\n\n  return (\n    <div\n      ref={node}\n      className={classNameProps ? `${classNameProps} ${classes}` : classes}\n      style={Object.assign({}, style, styleProps)}\n    >\n      {children}\n    </div>\n  );\n};\n"]}